<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Deploy a Flask Application on an Ubuntu VPS (DigitalOcean) - Programming Notes</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Deploy a Flask Application on an Ubuntu VPS (DigitalOcean)";
    var mkdocs_page_input_path = "general\\ubuntu-vps.md";
    var mkdocs_page_url = "/general/ubuntu-vps/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../../README/" class="icon icon-home"> Programming Notes</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../../README/">Programming Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">General</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../batch-script/">Create a Windows batch script</a>
                </li>
                <li class="">
                    
    <a class="" href="../crontab/">Linux Crontab</a>
                </li>
                <li class="">
                    
    <a class="" href="../deploy-django/">Deploy a Django app in an Ubuntu VPS (DigitalOcean)</a>
                </li>
                <li class="">
                    
    <a class="" href="../dev-environments/">Development environments</a>
                </li>
                <li class="">
                    
    <a class="" href="../git/">Git Version Control System</a>
                </li>
                <li class="">
                    
    <a class="" href="../keep-ssh-running/">Keep SSH sessions running after disconnecting</a>
                </li>
                <li class="">
                    
    <a class="" href="../os-env-vars/">Hiding Passwords and Secret Keys in Environment Variables</a>
                </li>
                <li class="">
                    
    <a class="" href="../server-setup/">Initial Server Setup with Ubuntu 18.04</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Deploy a Flask Application on an Ubuntu VPS (DigitalOcean)</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#deploy-a-flask-application-on-an-ubuntu-vps-digitalocean">Deploy a Flask Application on an Ubuntu VPS (DigitalOcean)</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#1-install-apache">1) Install Apache</a></li>
        
            <li><a class="toctree-l4" href="#2-install-mysql">2) Install MySQL</a></li>
        
            <li><a class="toctree-l4" href="#3-install-and-enable-mod_wsgi">3) Install and enable mod_wsgi</a></li>
        
            <li><a class="toctree-l4" href="#4-install-flask-and-virtualenv">4) Install Flask and virtualenv</a></li>
        
            <li><a class="toctree-l4" href="#5-configure-and-enable-a-new-virtual-host">5) Configure and Enable a New Virtual Host</a></li>
        
            <li><a class="toctree-l4" href="#6-create-the-wsgi-file">6) Create the .wsgi File</a></li>
        
            <li><a class="toctree-l4" href="#7-restart-apache">7) Restart Apache</a></li>
        
            <li><a class="toctree-l4" href="#final-directory-structure">Final directory structure</a></li>
        
            <li><a class="toctree-l4" href="#useful-references">Useful references:</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../web-dev-resources/">Web dev resources</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Html css</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../html-css/css-selectors/">Css selectors</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Javascript</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../javascript/DataTables/">DataTables</a>
                </li>
                <li class="">
                    
    <a class="" href="../../javascript/cache-data/">Cache data</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Python</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../python/args-kwargs/">Args kwargs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/beautifulsoup4/">Beautifulsoup4</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/builtin-functions/">Builtin functions</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/classes/">Classes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/csv/">Csv</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/django/">Django</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/email/">Email</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/flask/">Flask</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/hosting/">Hosting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/image-manipulation/">Image manipulation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/imports/">Imports</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/magic-methods/">Magic methods</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/matlab/">Matlab</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/mysql/">Mysql</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/progress-bar/">Progress bar</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/slice-notation/">Slice notation</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/snippets/">Snippets</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/store-dicts/">Store dicts</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/stravalib/">Stravalib</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/string-formatting/">String formatting</a>
                </li>
                <li class="">
                    
    <a class="" href="../../python/virtual-environments/">Virtual environments</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../README/">Programming Notes</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../README/">Docs</a> &raquo;</li>
    
      
        
          <li>General &raquo;</li>
        
      
    
    <li>Deploy a Flask Application on an Ubuntu VPS (DigitalOcean)</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="deploy-a-flask-application-on-an-ubuntu-vps-digitalocean">Deploy a Flask Application on an Ubuntu VPS (DigitalOcean)</h1>
<p>This page details the process of seting up a Ubuntu VPS (in this case a DigitalOcean dropplet using Ubuntu 16.04 was used) to serve a Flask based websiite. MySQL databases are used.</p>
<h2 id="1-install-apache">1) Install Apache</h2>
<pre><code>$ sudo apt-get update
$ sudo apt-get upgrade
$ sudo apt-get install apache2
</code></pre>

<p>You can do a spot check right away to verify that everything went as planned by visiting your server's public IP address in your web browser. You will see the default Ubuntu 16.04 Apache web page.</p>
<pre><code>http://your_server_IP_address
</code></pre>

<h3 id="how-to-find-your-servers-public-ip-address">How To Find your Server's Public IP Address</h3>
<p>Usually, this is the address you use to connect to your server through SSH. However you can find the IP address from the command line by typing this:</p>
<pre><code>$ ip addr show eth0 | grep inet | awk '{ print $2; }' | sed 's/\/.*$//'
</code></pre>

<p>Alternatively you can use <code>curl</code> to contact an outside party to tell you how it sees your server. You can do this by asking a specific server what your IP address is:</p>
<pre><code>$ sudo apt-get install curl
$ curl http://icanhazip.com
</code></pre>

<h2 id="2-install-mysql">2) Install MySQL</h2>
<pre><code>$ sudo apt-get install mysql-server mysql-client
</code></pre>

<p>During the installation, your server will ask you to select and confirm a password for the MySQL "root" user. This is an administrative account in MySQL that has increased privileges. Think of it as being similar to the root account for the server itself (the one you are configuring now is a MySQL-specific account, however). Make sure this is a strong, unique password, and do not leave it blank.</p>
<p><strong>Optional:</strong> Run a simple security script that will remove some dangerous defaults and lock down access to our database system a little bit. See more info on this on reference [2].</p>
<pre><code>$ mysql_secure_installation
</code></pre>

<h2 id="3-install-and-enable-mod_wsgi">3) Install and enable mod_wsgi</h2>
<p>WSGI (Web Server Gateway Interface) is an interface between web servers and web apps for python. Mod_wsgi is an Apache HTTP server mod that enables Apache to serve Flask applications.</p>
<pre><code>$ cd /var/www
</code></pre>

<p>Copy in your Flask app directory struture. It should look like this:</p>
<pre><code>|----FlaskApp
|---------FlaskApp
|--------------static
|--------------templates
|--------------__init__.py
</code></pre>

<h2 id="4-install-flask-and-virtualenv">4) Install Flask and virtualenv</h2>
<p>Install <code>pip</code></p>
<pre><code>$ sudo apt-get install python-pip 
</code></pre>

<p>Install <code>virtualenv</code> and create a new virtual environment names <code>venv</code> for the Flask app</p>
<pre><code>$ sudo pip install virtualenv 
$ cd /var/www/FlaskApp/FlaskApp
$ sudo virtualenv venv
$ source venv/bin/activate 
</code></pre>

<p>Install <code>Flask</code> and other necessary Flask plug-ins and extensions</p>
<pre><code>$ sudo pip install Flask 
$ sudo pip install flask-mysqldb
$ sudo pip install Flask-WTF
$ sudo pip install passlib
</code></pre>

<p>Test if the installation is successful and the app is running:</p>
<pre><code>$ sudo python __init__.py 
</code></pre>

<p>It should display “Running on http://localhost:5000/” or "Running on http://127.0.0.1:5000/". If you see this message, you have successfully configured the app.</p>
<p>To deactivate the environment, give the following command:</p>
<pre><code>$ deactivate
</code></pre>

<h2 id="5-configure-and-enable-a-new-virtual-host">5) Configure and Enable a New Virtual Host</h2>
<pre><code>$ sudo nano /etc/apache2/sites-available/FlaskApp.conf
</code></pre>

<p>Add the following lines of code to the file to configure the virtual host. Be sure to change the ServerName to your domain or cloud server's IP address:</p>
<pre><code>&lt;VirtualHost *:80&gt;
        ServerName mywebsite.com
        ServerAlias www.mywebsite.com
        ServerAdmin admin@mywebsite.com
        WSGIScriptAlias / /var/www/FlaskApp/flaskapp.wsgi
        &lt;Directory /var/www/FlaskApp/FlaskApp/&gt;
            Order allow,deny
            Allow from all
        &lt;/Directory&gt;
        Alias /static /var/www/FlaskApp/FlaskApp/static
        &lt;Directory /var/www/FlaskApp/FlaskApp/static/&gt;
            Order allow,deny
            Allow from all
        &lt;/Directory&gt;
        ErrorLog ${APACHE_LOG_DIR}/error.log
        LogLevel warn
        CustomLog ${APACHE_LOG_DIR}/access.log combined
&lt;/VirtualHost&gt;
</code></pre>

<p>Enable the virtual host with the following command:</p>
<pre><code>$ sudo a2ensite FlaskApp
</code></pre>

<h2 id="6-create-the-wsgi-file">6) Create the .wsgi File</h2>
<pre><code>$ cd /var/www/FlaskApp
$ sudo nano flaskapp.wsgi 
</code></pre>

<p>Add the following lines of code to the flaskapp.wsgi file:</p>
<pre><code>#!/usr/bin/python
import sys
import logging
logging.basicConfig(stream=sys.stderr)
sys.path.insert(0,&quot;/var/www/FlaskApp/&quot;)

from FlaskApp import app as application
application.secret_key = 'Add your secret key'
</code></pre>

<h2 id="7-restart-apache">7) Restart Apache</h2>
<pre><code>$ sudo service apache2 restart 
</code></pre>

<p>To view your application, open your browser and navigate to the domain name or IP address that you entered in your virtual host configuration.</p>
<h2 id="final-directory-structure">Final directory structure</h2>
<pre><code>|--------FlaskApp
|----------------FlaskApp
|-----------------------static
|-----------------------templates
|-----------------------venv
|-----------------------__init__.py
|----------------flaskapp.wsgi
</code></pre>

<h2 id="useful-references">Useful references:</h2>
<p>1) <a href="https://www.digitalocean.com/community/tutorials/how-to-deploy-a-flask-application-on-an-ubuntu-vps">How To Deploy a Flask Application on an Ubuntu VPS</a>
2) <a href="https://www.digitalocean.com/community/tutorials/how-to-install-linux-apache-mysql-php-lamp-stack-on-ubuntu-16-04">How To Install Linux, Apache, MySQL, PHP (LAMP) stack on Ubuntu 16.04</a>
3) <a href="https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-16-04">Initial Server Setup with Ubuntu 16.04</a>
4) <a href="blob/master/python/flask.md">Building a Flask site</a></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../web-dev-resources/" class="btn btn-neutral float-right" title="Web dev resources">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../server-setup/" class="btn btn-neutral" title="Initial Server Setup with Ubuntu 18.04"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../server-setup/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../web-dev-resources/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/require.js"></script>
      <script src="../../search/search.js"></script>

</body>
</html>
